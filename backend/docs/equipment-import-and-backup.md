# Импорт ноутбуков в раздел «Техника» и backup базы данных

Ниже — готовый способ массово добавить список ноутбуков Aquarius Cmp NS685U R11 и сделать резервную копию БД.

## 1) Подготовка файла импорта

В репозиторий добавлены отдельные файлы для импорта:

- `backend/data/laptops_ns685u_r11.tsv` — исходные данные 40 ноутбуков;
- `backend/app/importers/laptops_import.py` — отдельный модуль импорта в таблицу `equipment`.

Формат — табличный (разделитель `\t`) с колонками:

- `№ п/п`
- `МНИ`
- `Модель`
- `S/N`
- `СТАТУС`
- `Звание`
- `ФИО Ответственного`
- `Состояние`
- `Комплектация`
- `Примечание`

## 2) Импорт в «Техника»

Из каталога `backend` выполните:

```bash
python -m app.cli import-laptops
```

Если хотите использовать другой файл:

```bash
python -m app.cli import-laptops --file /путь/к/файлу.tsv
```

Что делает импорт:

- добавляет/обновляет записи `equipment` по `S/N`;
- выставляет тип `Ноутбук`, производителя `Aquarius`, модель из файла;
- маппит `СТАТУС`:
  - `Выдан` → `В работе`
  - `На складе` → `На складе`;
- пытается привязать `ФИО Ответственного` к `personnel` (создаёт запись, если её нет);
- выставляет комплектность (`has_charger`, `has_mouse`) по полю `Комплектация`;
- сохраняет `Состояние`, `Комплектация` и `Примечание` в поле `notes`.

## 3) Backup базы данных

### Вариант A — через CLI проекта

Автоматически создаёт файл в папке `backend/backups/`:

```bash
python -m app.cli backup-db
```

Можно указать свой путь:

```bash
python -m app.cli backup-db --output ./backups/manual_backup.sql
```

### Вариант B — вручную (PostgreSQL)

```bash
pg_dump "$DATABASE_URL" -f ./backups/zgt_backup.sql
```

### Вариант C — вручную (SQLite)

```bash
cp ./zgt.db ./backups/zgt_backup.sqlite3
```

## 4) Рекомендуемый порядок перед массовым импортом

1. Сделать backup.
2. Запустить импорт.
3. Проверить раздел `/equipment` в UI (фильтры «В работе»/«На складе»).
4. При необходимости скорректировать отдельные карточки техники.
